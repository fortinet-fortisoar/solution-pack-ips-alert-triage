{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "B: Fetch Vulnerability Details - Auto",
    "aliasName": null,
    "tag": null,
    "description": null,
    "isActive": true,
    "debug": true,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "lastModifyDate": 1645552903,
    "collection": "\/api\/3\/workflow_collections\/5b5e50c1-2ae8-4cf7-b4fb-e6ac730eda61",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/3b64b01a-da72-4c80-9b04-2197f70174eb",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Compile Attributes",
            "description": null,
            "arguments": {
                "__temp0": "{%for item in vars.plugin_details.attributes%}{{vars.attr_list.update({item.attribute_name:item.attribute_value})}}\n{%endfor%}"
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "387e4358-de2e-4c44-b4d8-7d06790f68ff",
            "id": 7935
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Vulnerability Details",
            "description": null,
            "arguments": {
                "name": "Nessus",
                "config": "e6224021-ce01-4e32-b6a2-360825c1cca8",
                "params": {
                    "plugin_id": "{{vars.input.records[0].vulnerabilityId}}"
                },
                "version": "1.0.0",
                "connector": "nessus",
                "operation": "get_plugin_details",
                "mock_result": "{\n  \"data\": {\n    \"id\": 138600,\n    \"name\": \"Windows DNS Server RCE (CVE-2020-1350)\",\n    \"attributes\": [\n      {\n        \"attribute_name\": \"fname\",\n        \"attribute_value\": \"smb_nt_ms20_jul_dns_check.nasl\"\n      },\n      {\n        \"attribute_name\": \"plugin_name\",\n        \"attribute_value\": \"Windows DNS Server RCE (CVE-2020-1350)\"\n      },\n      {\n        \"attribute_name\": \"script_version\",\n        \"attribute_value\": \"1.6\"\n      },\n      {\n        \"attribute_name\": \"script_copyright\",\n        \"attribute_value\": \"This script is Copyright (C) 2020 and is owned by Tenable, Inc. or an Affiliate thereof.\"\n      },\n      {\n        \"attribute_name\": \"exploitability_ease\",\n        \"attribute_value\": \"Exploits are available\"\n      },\n      {\n        \"attribute_name\": \"cvss3_temporal_vector\",\n        \"attribute_value\": \"CVSS:3.0\/E:H\/RL:O\/RC:C\"\n      },\n      {\n        \"attribute_name\": \"vuln_publication_date\",\n        \"attribute_value\": \"2020\/07\/14\"\n      },\n      {\n        \"attribute_name\": \"cpe\",\n        \"attribute_value\": \"cpe:\/o:microsoft:windows\"\n      },\n      {\n        \"attribute_name\": \"cvss3_vector\",\n        \"attribute_value\": \"CVSS:3.0\/AV:N\/AC:L\/PR:N\/UI:N\/S:C\/C:H\/I:H\/A:H\"\n      },\n      {\n        \"attribute_name\": \"cvss_score_source\",\n        \"attribute_value\": \"CVE-2020-1350\"\n      },\n      {\n        \"attribute_name\": \"cvss_temporal_vector\",\n        \"attribute_value\": \"CVSS2#E:H\/RL:OF\/RC:C\"\n      },\n      {\n        \"attribute_name\": \"solution\",\n        \"attribute_value\": \"Apply the appropriate security update or mitigation as described in the Microsoft advisory.\"\n      },\n      {\n        \"attribute_name\": \"risk_factor\",\n        \"attribute_value\": \"Critical\"\n      },\n      {\n        \"attribute_name\": \"cvss_temporal_score\",\n        \"attribute_value\": \"8.7\"\n      },\n      {\n        \"attribute_name\": \"description\",\n        \"attribute_value\": \"The remote Windows host is missing a security update. It is, \\ntherefore, affected by a remote code execution vulnerability:\\n\\n  - A remote code execution vulnerability exists in Windows\\n    Domain Name System servers when they fail to properly\\n    handle requests. An attacker who successfully exploited\\n    the vulnerability could run arbitrary code in the\\n    context of the Local System Account. Windows servers\\n    that are configured as DNS servers are at risk from this\\n    vulnerability.  (CVE-2020-1350)\\n\\nNote: Tenable is testing for the presence of updates which address this issue, as well as Microsoft's recommended\\nmitigation\/workaround.\\n\\nThe registry key being checked for the mitigation is:\\n  - HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\DNS\\\\Parameters\\\\TcpReceivePacketSize\\nand it is being checked for Microsoft's recommended value of 0xFF00.\\n\\nOnce in place, the DNS Service must be restarted for the change to take effect.\\n\\nFor more information, refer to the Microsoft advisory for CVE-2020-1350.\"\n      },\n      {\n        \"attribute_name\": \"plugin_publication_date\",\n        \"attribute_value\": \"2020\/07\/17\"\n      },\n      {\n        \"attribute_name\": \"exploited_by_malware\",\n        \"attribute_value\": \"true\"\n      },\n      {\n        \"attribute_name\": \"cvss3_base_score\",\n        \"attribute_value\": \"10.0\"\n      },\n      {\n        \"attribute_name\": \"cvss_vector\",\n        \"attribute_value\": \"CVSS2#AV:N\/AC:L\/Au:N\/C:C\/I:C\/A:C\"\n      },\n      {\n        \"attribute_name\": \"plugin_type\",\n        \"attribute_value\": \"local\"\n      },\n      {\n        \"attribute_name\": \"synopsis\",\n        \"attribute_value\": \"The remote Windows host is affected by multiple vulnerabilities.\"\n      },\n      {\n        \"attribute_name\": \"patch_publication_date\",\n        \"attribute_value\": \"2020\/07\/14\"\n      },\n      {\n        \"attribute_name\": \"cvss3_temporal_score\",\n        \"attribute_value\": \"9.5\"\n      },\n      {\n        \"attribute_name\": \"see_also\",\n        \"attribute_value\": \"http:\/\/www.nessus.org\/u?6a916fa9\\nhttp:\/\/www.nessus.org\/u?f3307e60\"\n      },\n      {\n        \"attribute_name\": \"exploit_available\",\n        \"attribute_value\": \"true\"\n      },\n      {\n        \"attribute_name\": \"plugin_modification_date\",\n        \"attribute_value\": \"2020\/10\/19\"\n      },\n      {\n        \"attribute_name\": \"cvss_base_score\",\n        \"attribute_value\": \"10.0\"\n      },\n      {\n        \"attribute_name\": \"stig_severity\",\n        \"attribute_value\": \"I\"\n      },\n      {\n        \"attribute_name\": \"cve\",\n        \"attribute_value\": \"CVE-2020-1350\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSKB:4558998\"\n      },\n      {\n        \"attribute_name\": \"mskb\",\n        \"attribute_value\": \"4558998\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSKB:4565483\"\n      },\n      {\n        \"attribute_name\": \"mskb\",\n        \"attribute_value\": \"4565483\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSKB:4565483\"\n      },\n      {\n        \"attribute_name\": \"mskb\",\n        \"attribute_value\": \"4565483\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSKB:4565503\"\n      },\n      {\n        \"attribute_name\": \"mskb\",\n        \"attribute_value\": \"4565503\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSKB:4565511\"\n      },\n      {\n        \"attribute_name\": \"mskb\",\n        \"attribute_value\": \"4565511\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSKB:4565524\"\n      },\n      {\n        \"attribute_name\": \"mskb\",\n        \"attribute_value\": \"4565524\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSKB:4565529\"\n      },\n      {\n        \"attribute_name\": \"mskb\",\n        \"attribute_value\": \"4565529\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSKB:4565535\"\n      },\n      {\n        \"attribute_name\": \"mskb\",\n        \"attribute_value\": \"4565535\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSKB:4565536\"\n      },\n      {\n        \"attribute_name\": \"mskb\",\n        \"attribute_value\": \"4565536\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSKB:4565537\"\n      },\n      {\n        \"attribute_name\": \"mskb\",\n        \"attribute_value\": \"4565537\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSKB:4565539\"\n      },\n      {\n        \"attribute_name\": \"mskb\",\n        \"attribute_value\": \"4565539\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSKB:4565540\"\n      },\n      {\n        \"attribute_name\": \"mskb\",\n        \"attribute_value\": \"4565540\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSKB:4565541\"\n      },\n      {\n        \"attribute_name\": \"mskb\",\n        \"attribute_value\": \"4565541\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSFT:MS20-4558998\"\n      },\n      {\n        \"attribute_name\": \"msft\",\n        \"attribute_value\": \"MS20-4558998\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSFT:MS20-4565483\"\n      },\n      {\n        \"attribute_name\": \"msft\",\n        \"attribute_value\": \"MS20-4565483\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSFT:MS20-4565483\"\n      },\n      {\n        \"attribute_name\": \"msft\",\n        \"attribute_value\": \"MS20-4565483\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSFT:MS20-4565503\"\n      },\n      {\n        \"attribute_name\": \"msft\",\n        \"attribute_value\": \"MS20-4565503\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSFT:MS20-4565511\"\n      },\n      {\n        \"attribute_name\": \"msft\",\n        \"attribute_value\": \"MS20-4565511\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSFT:MS20-4565524\"\n      },\n      {\n        \"attribute_name\": \"msft\",\n        \"attribute_value\": \"MS20-4565524\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSFT:MS20-4565529\"\n      },\n      {\n        \"attribute_name\": \"msft\",\n        \"attribute_value\": \"MS20-4565529\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSFT:MS20-4565535\"\n      },\n      {\n        \"attribute_name\": \"msft\",\n        \"attribute_value\": \"MS20-4565535\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSFT:MS20-4565536\"\n      },\n      {\n        \"attribute_name\": \"msft\",\n        \"attribute_value\": \"MS20-4565536\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSFT:MS20-4565537\"\n      },\n      {\n        \"attribute_name\": \"msft\",\n        \"attribute_value\": \"MS20-4565537\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSFT:MS20-4565539\"\n      },\n      {\n        \"attribute_name\": \"msft\",\n        \"attribute_value\": \"MS20-4565539\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSFT:MS20-4565540\"\n      },\n      {\n        \"attribute_name\": \"msft\",\n        \"attribute_value\": \"MS20-4565540\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"MSFT:MS20-4565541\"\n      },\n      {\n        \"attribute_name\": \"msft\",\n        \"attribute_value\": \"MS20-4565541\"\n      },\n      {\n        \"attribute_name\": \"xref\",\n        \"attribute_value\": \"IAVA:2020-A-0299\"\n      },\n      {\n        \"attribute_name\": \"iava\",\n        \"attribute_value\": \"2020-A-0299\"\n      },\n      {\n        \"attribute_name\": \"dependency\",\n        \"attribute_value\": \"smb_check_rollup.nasl\"\n      },\n      {\n        \"attribute_name\": \"dependency\",\n        \"attribute_value\": \"smb_hotfixes.nasl\"\n      },\n      {\n        \"attribute_name\": \"dependency\",\n        \"attribute_value\": \"ms_bulletin_checks_possible.nasl\"\n      },\n      {\n        \"attribute_name\": \"dependency\",\n        \"attribute_value\": \"wmi_enum_server_features.nbin\"\n      },\n      {\n        \"attribute_name\": \"required_key\",\n        \"attribute_value\": \"SMB\/MS_Bulletin_Checks\/Possible\"\n      },\n      {\n        \"attribute_name\": \"required_key\",\n        \"attribute_value\": \"SMB\/WMI\/Available\"\n      },\n      {\n        \"attribute_name\": \"required_port\",\n        \"attribute_value\": \"139\"\n      },\n      {\n        \"attribute_name\": \"required_port\",\n        \"attribute_value\": \"445\"\n      },\n      {\n        \"attribute_name\": \"required_port\",\n        \"attribute_value\": \"Host\/patch_management_checks\"\n      }\n    ],\n    \"family_name\": \"Windows : Microsoft Bulletins\"\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Get Plugin Information",
                "step_variables": []
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "8ecaafbe-f22b-43b8-acfd-98f07ef38bf7",
            "id": 7936
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "resource": "vulnerabilities",
                "resources": [
                    "vulnerabilities"
                ],
                "step_variables": {
                    "input": {
                        "records": [
                            "{{vars.input.records[0]}}"
                        ]
                    },
                    "useMockOutput": "True"
                },
                "fieldbasedtrigger": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "vulnerabilityId",
                            "value": "138600",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ]
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/ea155646-3821-4542-9702-b246da430a8d",
            "uuid": "3b64b01a-da72-4c80-9b04-2197f70174eb",
            "id": 7937
        },
        {
            "@type": "WorkflowStep",
            "name": "Input Data",
            "description": null,
            "arguments": {
                "attr_list": "{}",
                "plugin_details": "{{vars.steps.Get_Vulnerability_Details.data}}"
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "30a41b64-1eac-4b80-aa03-a5316327bc00",
            "id": 7938
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Vulnerability",
            "description": null,
            "arguments": {
                "resource": {
                    "cvss": "{{vars.attr_list.cvss_temporal_score}}",
                    "risk": "{{vars.attr_list.risk_factor}}-{{vars.attr_list.cpe}}",
                    "cveId": "{{vars.attr_list.cve}}",
                    "__link": {
                        "recordTags": [
                            "\/api\/3\/tags\/Nessus"
                        ]
                    },
                    "status": {
                        "id": 219,
                        "@id": "\/api\/3\/picklists\/e001be1d-d050-473c-a82d-003bf14c4b1b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": "#A51516",
                        "display": "Open",
                        "listName": "\/api\/3\/picklist_names\/0b2b995f-0292-43ca-be81-03904250791c",
                        "itemValue": "Open",
                        "orderIndex": 0
                    },
                    "cvssVector": "{{vars.attr_list.cvss_vector}}",
                    "pluginType": "{{vars.attr_list.plugin_type}}",
                    "sourceData": "Nessus",
                    "cvss3Vector": "{{vars.attr_list.cvss3_vector}}",
                    "description": "Severity:{{vars.attr_list.risk_factor}} {{vars.attr_list.description}} Solution: {{vars.attr_list.solution}}",
                    "exploitSkills": "Exploit available: {{vars.attr_list.exploit_available}} {{vars.attr_list.exploitability_ease}}",
                    "cvss3BaseScore": "{{vars.attr_list.cvss3_base_score}}",
                    "cvssTemporalScore": "{{vars.attr_list.cvss_temporal_score}}",
                    "cvss3TemporalScore": "{{vars.attr_list.cvss3_temporal_score}}",
                    "cvssTemporalVector": "{{vars.attr_list.cvss_temporal_vector}}",
                    "cvss3TemporalVector": "{{vars.attr_list.cvss3_temporal_vector}}",
                    "pluginPublicationDate": "{{vars.attr_list.plugin_publication_date}}",
                    "pluginModificationDate": "{{vars.attr_list.plugin_modification_date}}"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "\/api\/3\/vulnerabilities",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "570",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "7680210a-6ae8-433f-ae41-b8825b607b93",
            "id": 7939
        },
        {
            "@type": "WorkflowStep",
            "name": "Debug",
            "description": null,
            "arguments": {
                "all": "{{vars}}"
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "4adce734-6443-4515-a44a-df1305921f04",
            "id": 7940
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Input Data -> Copy  of Input Data",
            "targetStep": "\/api\/3\/workflow_steps\/387e4358-de2e-4c44-b4d8-7d06790f68ff",
            "sourceStep": "\/api\/3\/workflow_steps\/30a41b64-1eac-4b80-aa03-a5316327bc00",
            "label": null,
            "isExecuted": false,
            "uuid": "359c0f0d-3140-4a11-b14d-82e5e1163485"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Get Vulnerability Details",
            "targetStep": "\/api\/3\/workflow_steps\/8ecaafbe-f22b-43b8-acfd-98f07ef38bf7",
            "sourceStep": "\/api\/3\/workflow_steps\/3b64b01a-da72-4c80-9b04-2197f70174eb",
            "label": null,
            "isExecuted": false,
            "uuid": "988d74ac-85e5-48eb-98eb-6aabd4beb82a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Vulnerability -> Debug",
            "targetStep": "\/api\/3\/workflow_steps\/4adce734-6443-4515-a44a-df1305921f04",
            "sourceStep": "\/api\/3\/workflow_steps\/7680210a-6ae8-433f-ae41-b8825b607b93",
            "label": null,
            "isExecuted": false,
            "uuid": "69493d35-bb48-4866-adc4-1f2ce158ff3b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Compile Attributes -> Update Vulnerability",
            "targetStep": "\/api\/3\/workflow_steps\/7680210a-6ae8-433f-ae41-b8825b607b93",
            "sourceStep": "\/api\/3\/workflow_steps\/387e4358-de2e-4c44-b4d8-7d06790f68ff",
            "label": null,
            "isExecuted": false,
            "uuid": "6ceefd21-d52f-4bf1-8056-c4d015c16aab"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Vulnerability Details -> Input Data",
            "targetStep": "\/api\/3\/workflow_steps\/30a41b64-1eac-4b80-aa03-a5316327bc00",
            "sourceStep": "\/api\/3\/workflow_steps\/8ecaafbe-f22b-43b8-acfd-98f07ef38bf7",
            "label": null,
            "isExecuted": false,
            "uuid": "0edf36fc-4591-44f4-8710-cb0b0f49df77"
        }
    ],
    "priority": null,
    "uuid": "38a09a64-ffcb-4ea1-b099-5c1d6bfed88a",
    "recordTags": [],
    "id": 1553,
    "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "createDate": 1645552903,
    "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "modifyDate": 1645553911,
    "owners": [],
    "isPrivate": false
}